import{u as A,j as e,L as je,r,a as pe,E as W,c as ve,T as Se,G as L,C as ye,P as we,B as $,A as Ce,b as be,d as O,e as M,S as ke,I as k,V as Oe,f as Ee,g as Me,M as De,h as Ne,i as Ae,k as Re,l as Ve,m as Te,n as _e,R as Pe,H as Ue,o as Ie,p as He,q as Y,s as Fe,t as qe,v as D,w as Le}from"./vendor-C_U4Pllm.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const x of l.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&g(x)}).observe(document,{childList:!0,subtree:!0});function d(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerPolicy&&(l.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?l.credentials="include":c.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function g(c){if(c.ep)return;c.ep=!0;const l=d(c);fetch(c.href,l)}})();function Be(){const o=A();return e.jsxs("div",{className:"landingPageContainer",children:[e.jsxs("nav",{children:[e.jsx("div",{className:"navHeader",children:e.jsx("h2",{children:"Hangout Hub"})}),e.jsxs("div",{className:"navlist",children:[e.jsx("p",{onClick:()=>{o("/aljk23")},children:"Join as Guest"}),e.jsx("p",{onClick:()=>{o("/auth")},children:"Register"}),e.jsx("div",{onClick:()=>{o("/auth")},role:"button",children:e.jsx("p",{children:"Login"})})]})]}),e.jsxs("div",{className:"landingMainContainer",children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx("span",{style:{color:"#FF9839"},children:"Connect"})," with your loved Ones"]}),e.jsx("p",{children:"Cover a distance by Apna Video Call"}),e.jsx("div",{role:"button",children:e.jsx(je,{to:"/auth",children:"Get Started"})})]}),e.jsx("div",{children:e.jsx("img",{src:"/mobile.png",alt:""})})]})]})}const K="https://hangout-hubbackend.onrender.com",N=r.createContext({}),_=pe.create({baseURL:`${K}/api/v1/users`}),Je=({children:o})=>{const u=r.useContext(N),[d,g]=r.useState(u),c=A(),p={userData:d,setUserData:g,addToUserHistory:async h=>{try{return await _.post("/add_to_activity",{token:localStorage.getItem("token"),meeting_code:h})}catch(f){throw f}},getHistoryOfUser:async()=>{try{return(await _.get("/get_all_activity",{params:{token:localStorage.getItem("token")}})).data}catch(h){throw h}},handleRegister:async(h,f,v)=>{try{let y=await _.post("/register",{name:h,username:f,password:v});if(y.status===W.CREATED)return y.data.message}catch(y){throw y}},handleLogin:async(h,f)=>{try{let v=await _.post("/login",{username:h,password:f});console.log(h,f),console.log(v.data),v.status===W.OK&&(localStorage.setItem("token",v.data.token),c("/home"))}catch(v){throw v}}};return e.jsx(N.Provider,{value:p,children:o})},ze=ve();function Ge(){const[o,u]=r.useState(),[d,g]=r.useState(),[c,l]=r.useState(),[x,j]=r.useState(),[w,p]=r.useState(),[h,f]=r.useState(0),[v,y]=r.useState(!1),{handleRegister:P,handleLogin:U}=r.useContext(N);let R=async()=>{try{if(h===0){let m=await U(o,d)}if(h===1){let m=await P(c,o,d);console.log(m),u(""),p(m),y(!0),j(""),f(0),g("")}}catch(m){console.log(m);let I=m.response.data.message;j(I)}};return e.jsxs(Se,{theme:ze,children:[e.jsxs(L,{container:!0,component:"main",sx:{height:"100vh"},children:[e.jsx(ye,{}),e.jsx(L,{item:!0,xs:!1,sm:4,md:7,sx:{backgroundImage:"url(https://source.unsplash.com/random?wallpapers)",backgroundRepeat:"no-repeat",backgroundColor:m=>m.palette.mode==="light"?m.palette.grey[50]:m.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"}}),e.jsx(L,{item:!0,xs:12,sm:8,md:5,component:we,elevation:6,square:!0,children:e.jsxs($,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(Ce,{sx:{m:1,bgcolor:"secondary.main"},children:e.jsx(be,{})}),e.jsxs("div",{children:[e.jsx(O,{variant:h===0?"contained":"",onClick:()=>{f(0)},children:"Sign In"}),e.jsx(O,{variant:h===1?"contained":"",onClick:()=>{f(1)},children:"Sign Up"})]}),e.jsxs($,{component:"form",noValidate:!0,sx:{mt:1},children:[h===1?e.jsx(M,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Full Name",name:"username",value:c,autoFocus:!0,onChange:m=>l(m.target.value)}):e.jsx(e.Fragment,{}),e.jsx(M,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",value:o,autoFocus:!0,onChange:m=>u(m.target.value)}),e.jsx(M,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",value:d,type:"password",onChange:m=>g(m.target.value),id:"password"}),e.jsx("p",{style:{color:"red"},children:x}),e.jsx(O,{type:"button",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:R,children:h===0?"Login ":"Register"})]})]})})]}),e.jsx(ke,{open:v,autoHideDuration:4e3,message:w})]})}const We="_meetVideoContainer_qbvzi_1",$e="_meetUserVideo_qbvzi_13",Ye="_buttonContainers_qbvzi_31",Ke="_conferenceView_qbvzi_53",Qe="_chatRoom_qbvzi_83",Xe="_chatContainer_qbvzi_103",Ze="_chattingArea_qbvzi_115",C={meetVideoContainer:We,meetUserVideo:$e,buttonContainers:Ye,conferenceView:Ke,chatRoom:Qe,chatContainer:Xe,chattingArea:Ze},et=K;var i={};const tt={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};function st(){var o=r.useRef();let u=r.useRef(),d=r.useRef(),[g,c]=r.useState(!0),[l,x]=r.useState(!0),[j,w]=r.useState([]),[p,h]=r.useState(),[f,v]=r.useState(),[y,P]=r.useState(!0),[U,R]=r.useState(),[m,I]=r.useState([]),[B,J]=r.useState(""),[Q,X]=r.useState(3),[Z,ee]=r.useState(!0),[z,te]=r.useState("");const V=r.useRef([]);let[se,H]=r.useState([]);r.useEffect(()=>{console.log("HELLO"),ae()});let ne=()=>{f&&navigator.mediaDevices.getDisplayMedia&&navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then(ie).then(t=>{}).catch(t=>console.log(t))};const ae=async()=>{try{if(await navigator.mediaDevices.getUserMedia({video:!0})?(c(!0),console.log("Video permission granted")):(c(!1),console.log("Video permission denied")),await navigator.mediaDevices.getUserMedia({audio:!0})?(x(!0),console.log("Audio permission granted")):(x(!1),console.log("Audio permission denied")),navigator.mediaDevices.getDisplayMedia?R(!0):R(!1),g||l){const n=await navigator.mediaDevices.getUserMedia({video:g,audio:l});n&&(window.localStream=n,d.current&&(d.current.srcObject=n))}}catch(t){console.log(t)}};r.useEffect(()=>{j!==void 0&&p!==void 0&&(G(),console.log("SET STATE HAS ",j,p))},[j,p]);let re=()=>{w(g),h(l),le()},oe=t=>{try{window.localStream.getTracks().forEach(s=>s.stop())}catch(s){console.log(s)}window.localStream=t,d.current.srcObject=t;for(let s in i)s!==u.current&&(i[s].addStream(window.localStream),i[s].createOffer().then(n=>{console.log(n),i[s].setLocalDescription(n).then(()=>{o.current.emit("signal",s,JSON.stringify({sdp:i[s].localDescription}))}).catch(a=>console.log(a))}));t.getTracks().forEach(s=>s.onended=()=>{w(!1),h(!1);try{d.current.srcObject.getTracks().forEach(S=>S.stop())}catch(a){console.log(a)}let n=(...a)=>new MediaStream([q(...a),F()]);window.localStream=n(),d.current.srcObject=window.localStream;for(let a in i)i[a].addStream(window.localStream),i[a].createOffer().then(S=>{i[a].setLocalDescription(S).then(()=>{o.current.emit("signal",a,JSON.stringify({sdp:i[a].localDescription}))}).catch(b=>console.log(b))})})},G=()=>{if(j&&g||p&&l)navigator.mediaDevices.getUserMedia({video:j,audio:p}).then(oe).then(t=>{}).catch(t=>console.log(t));else try{d.current.srcObject.getTracks().forEach(s=>s.stop())}catch{}},ie=t=>{console.log("HERE");try{window.localStream.getTracks().forEach(s=>s.stop())}catch(s){console.log(s)}window.localStream=t,d.current.srcObject=t;for(let s in i)s!==u.current&&(i[s].addStream(window.localStream),i[s].createOffer().then(n=>{i[s].setLocalDescription(n).then(()=>{o.current.emit("signal",s,JSON.stringify({sdp:i[s].localDescription}))}).catch(a=>console.log(a))}));t.getTracks().forEach(s=>s.onended=()=>{v(!1);try{d.current.srcObject.getTracks().forEach(S=>S.stop())}catch(a){console.log(a)}let n=(...a)=>new MediaStream([q(...a),F()]);window.localStream=n(),d.current.srcObject=window.localStream,G()})},ce=(t,s)=>{var n=JSON.parse(s);t!==u.current&&(n.sdp&&i[t].setRemoteDescription(new RTCSessionDescription(n.sdp)).then(()=>{n.sdp.type==="offer"&&i[t].createAnswer().then(a=>{i[t].setLocalDescription(a).then(()=>{o.current.emit("signal",t,JSON.stringify({sdp:i[t].localDescription}))}).catch(S=>console.log(S))}).catch(a=>console.log(a))}).catch(a=>console.log(a)),n.ice&&i[t].addIceCandidate(new RTCIceCandidate(n.ice)).catch(a=>console.log(a)))},le=()=>{o.current=_e.connect(et,{secure:!1}),o.current.on("signal",ce),o.current.on("connect",()=>{o.current.emit("join-call",window.location.href),u.current=o.current.id,o.current.on("chat-message",ge),o.current.on("user-left",t=>{H(s=>s.filter(n=>n.socketId!==t))}),o.current.on("user-joined",(t,s)=>{if(s.forEach(n=>{if(i[n]=new RTCPeerConnection(tt),i[n].onicecandidate=function(a){a.candidate!=null&&o.current.emit("signal",n,JSON.stringify({ice:a.candidate}))},i[n].onaddstream=a=>{if(console.log("BEFORE:",V.current),console.log("FINDING ID: ",n),V.current.find(b=>b.socketId===n))console.log("FOUND EXISTING"),H(b=>{const T=b.map(E=>E.socketId===n?{...E,stream:a.stream}:E);return V.current=T,T});else{console.log("CREATING NEW");let b={socketId:n,stream:a.stream,autoplay:!0,playsinline:!0};H(T=>{const E=[...T,b];return V.current=E,E})}},window.localStream!==void 0&&window.localStream!==null)i[n].addStream(window.localStream);else{let a=(...S)=>new MediaStream([q(...S),F()]);window.localStream=a(),i[n].addStream(window.localStream)}}),t===u.current){for(let n in i)if(n!==u.current){try{i[n].addStream(window.localStream)}catch{}i[n].createOffer().then(a=>{i[n].setLocalDescription(a).then(()=>{o.current.emit("signal",n,JSON.stringify({sdp:i[n].localDescription}))}).catch(S=>console.log(S))})}}})})},F=()=>{let t=new AudioContext,s=t.createOscillator(),n=s.connect(t.createMediaStreamDestination());return s.start(),t.resume(),Object.assign(n.stream.getAudioTracks()[0],{enabled:!1})},q=({width:t=640,height:s=480}={})=>{let n=Object.assign(document.createElement("canvas"),{width:t,height:s});n.getContext("2d").fillRect(0,0,t,s);let a=n.captureStream();return Object.assign(a.getVideoTracks()[0],{enabled:!1})},de=()=>{w(!j)},ue=()=>{h(!p)};r.useEffect(()=>{f!==void 0&&ne()},[f]);let he=()=>{v(!f)},me=()=>{try{d.current.srcObject.getTracks().forEach(s=>s.stop())}catch{}window.location.href="/"};const ge=(t,s,n)=>{I(a=>[...a,{sender:s,data:t}]),n!==u.current&&X(a=>a+1)};let xe=()=>{console.log(o.current),o.current.emit("chat-message",B,z),J("")},fe=()=>{ee(!1),re()};return e.jsx("div",{children:Z===!0?e.jsxs("div",{children:[e.jsx("h2",{children:"Enter into Lobby "}),e.jsx(M,{id:"outlined-basic",label:"Username",value:z,onChange:t=>te(t.target.value),variant:"outlined"}),e.jsx(O,{variant:"contained",onClick:fe,children:"Connect"}),e.jsx("div",{children:e.jsx("video",{ref:d,autoPlay:!0,muted:!0})})]}):e.jsxs("div",{className:C.meetVideoContainer,children:[y?e.jsx("div",{className:C.chatRoom,children:e.jsxs("div",{className:C.chatContainer,children:[e.jsx("h1",{children:"Chat"}),e.jsx("div",{className:C.chattingDisplay,children:m.length!==0?m.map((t,s)=>(console.log(m),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("p",{style:{fontWeight:"bold"},children:t.sender}),e.jsx("p",{children:t.data})]},s))):e.jsx("p",{children:"No Messages Yet"})}),e.jsxs("div",{className:C.chattingArea,children:[e.jsx(M,{value:B,onChange:t=>J(t.target.value),id:"outlined-basic",label:"Enter Your chat",variant:"outlined"}),e.jsx(O,{variant:"contained",onClick:xe,children:"Send"})]})]})}):e.jsx(e.Fragment,{}),e.jsxs("div",{className:C.buttonContainers,children:[e.jsx(k,{onClick:de,style:{color:"white"},children:j===!0?e.jsx(Oe,{}):e.jsx(Ee,{})}),e.jsx(k,{onClick:me,style:{color:"red"},children:e.jsx(Me,{})}),e.jsx(k,{onClick:ue,style:{color:"white"},children:p===!0?e.jsx(De,{}):e.jsx(Ne,{})}),U===!0?e.jsx(k,{onClick:he,style:{color:"white"},children:f===!0?e.jsx(Ae,{}):e.jsx(Re,{})}):e.jsx(e.Fragment,{}),e.jsx(Ve,{badgeContent:Q,max:999,color:"orange",children:e.jsxs(k,{onClick:()=>P(!y),style:{color:"white"},children:[e.jsx(Te,{}),"                        "]})})]}),e.jsx("video",{className:C.meetUserVideo,ref:d,autoPlay:!0,muted:!0}),e.jsx("div",{className:C.conferenceView,children:se.map(t=>e.jsx("div",{children:e.jsx("video",{"data-socket":t.socketId,ref:s=>{s&&t.stream&&(s.srcObject=t.stream)},autoPlay:!0})},t.socketId))})]})})}const nt=o=>d=>{const g=A(),c=()=>!!localStorage.getItem("token");return r.useEffect(()=>{c()||g("/auth")},[]),e.jsx(o,{...d})};function at(){let o=A();const[u,d]=r.useState(""),{addToUserHistory:g}=r.useContext(N);let c=async()=>{await g(u),o(`/${u}`)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"navBar",children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("h2",{children:"Hangout Hub"})}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(k,{onClick:()=>{o("/history")},children:e.jsx(Pe,{})}),e.jsx("p",{children:"History"}),e.jsx(O,{onClick:()=>{localStorage.removeItem("token"),o("/auth")},children:"Logout"})]})]}),e.jsxs("div",{className:"meetContainer",children:[e.jsx("div",{className:"leftPanel",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Providing Quality Video Call Just Like Quality Education"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx(M,{onChange:l=>d(l.target.value),id:"outlined-basic",label:"Meeting Code",variant:"outlined"}),e.jsx(O,{onClick:c,variant:"contained",children:"Join"})]})]})}),e.jsx("div",{className:"rightPanel",children:e.jsx("img",{srcSet:"/logo3.png",alt:""})})]})]})}const rt=nt(at);function ot(){const{getHistoryOfUser:o}=r.useContext(N),[u,d]=r.useState([]),g=A();r.useEffect(()=>{(async()=>{try{const x=await o();d(x)}catch{}})()},[]);let c=l=>{const x=new Date(l),j=x.getDate().toString().padStart(2,"0"),w=(x.getMonth()+1).toString().padStart(2,"0"),p=x.getFullYear();return`${j}/${w}/${p}`};return e.jsxs("div",{children:[e.jsx(k,{onClick:()=>{g("/home")},children:e.jsx(Ue,{})}),u.length!==0?u.map((l,x)=>e.jsx(e.Fragment,{children:e.jsx(Ie,{variant:"outlined",children:e.jsxs(He,{children:[e.jsxs(Y,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:["Code: ",l.meetingCode]}),e.jsxs(Y,{sx:{mb:1.5},color:"text.secondary",children:["Date: ",c(l.date)]})]})},x)})):e.jsx(e.Fragment,{})]})}function it(){return e.jsx("div",{className:"App",children:e.jsx(Fe,{children:e.jsx(Je,{children:e.jsxs(qe,{children:[e.jsx(D,{path:"/",element:e.jsx(Be,{})}),e.jsx(D,{path:"/auth",element:e.jsx(Ge,{})}),e.jsx(D,{path:"/home",element:e.jsx(rt,{})}),e.jsx(D,{path:"/history",element:e.jsx(ot,{})}),e.jsx(D,{path:"/:url",element:e.jsx(st,{})})]})})})})}Le.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(it,{})}));
